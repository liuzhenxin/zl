
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>WEB打印控件LODOP的样例二:打印当前页面的内容</title>

<script language="javascript" src="LodopFuncs.js"></script>
</head>
<body>
<h2><font color="#009999">演示如何打印当前页面的内容：</font>
</h2>
<form id="form1">
  <table border="1" width="300" id="tb01" bgcolor="#CCFFCC" style="border:solid 1px black;border-collapse:collapse"><tr><td width="133" id="mtb001">
  <font face="黑体" color="#FF0000" size="3"><u>&nbsp;《表单一》&nbsp;</u></font></td></tr></table>
  <table border="1" width="300" height="106" cellspacing="0" bgcolor="#CCFFFF"style="border-collapse:collapse;table-layout:fixed;border:solid 1px black;"><tr>
  <td width="66" height="16" style="border:solid 1px black"><font color="#0000FF">A</font><font color="#0000FF">等</font></td>
<td width="51" height="16" style="border:solid 1px black"><font color="#0000FF">B</font><font color="#0000FF">等</font></td>
<td width="51" height="16" style="border:solid 1px black"><font color="#0000FF">C</font><font color="#0000FF">等</font></td></tr> 
<tr>
<td width="66" height="16" style="border:solid 1px black">刘洋</sub></td>
<td width="80" height="12" style="border:solid 1px black">欠费一亿</td>
<td width="51" height="12" style="border:solid 1px black">不还弄凶</sup></td>
</tr> 
<tr>
<td width="66" height="16" style="border:solid 1px black">刘洋</sub></td>
<td width="80" height="12" style="border:solid 1px black">欠费一亿</td>
<td width="51" height="12" style="border:solid 1px black">不还弄凶</sup></td>
</tr> 
<td width="66" height="16" style="border:solid 1px black">刘洋</sub></td>
<td width="80" height="12" style="border:solid 1px black">欠费一亿</td>
<td width="51" height="12" style="border:solid 1px black">不还弄凶</sup></td>
</td></tr> </table>
</form>
<br>
<div id="form2">
  <table border="1" width="100%" id="tb01" bgcolor="#CCFFCC" style="border:solid 1px black;border-collapse:collapse"><tr><td width="133" id="mtb001">
  <font face="黑体" color="#FF0000" size="3">《表单二》&copy;</font></td></tr></table>
  <table border="1" width="100%" height="106" cellspacing="0" bgcolor="#CCFFFF" style="border:solid 1px black;border-collapse:collapse"><tr>
  <td width="66" height="16" style="border:solid 1px black"><font color="#0000FF">X</font><font color="#0000FF">等</font></td>
<td width="51" height="16" style="border:solid 1px black"><font color="#0000FF">Y等</font></td>
<td width="51" height="16" style="border:solid 1px black"><font color="#0000FF">Z等</font></td></tr> 
  <tr><td width="66" height="12" style="border:solid 1px black"><span style="font-family:Wingdings;font-size:25px;" >&#254;</span>X001</td>
<td width="51" height="12" style="border:solid 1px black"><strike>Y001</strike></td>
<td width="51" height="44" rowspan="3"  style="border:solid 1px black">
      <ol style="list-style-type:upper-alpha;list-style-position:inside;">
        <li>Z001</li>
        <li>Z002</li>
        <li>Z003</li>
        <li>Z004</li>
        <li>Z005</li>
       </ol>
    </td></tr> 
<tr><td width="30%" height="16" style="border:solid 1px black"><strong>X002</strong></td>
<td width="51" height="16"  style="border:solid 1px black"><u>Y002</u><span style="visibility: hidden">hidesome</span></td></tr> 
  <tr><td width="30%" height="16" style="border:solid 1px black"><span style="text-decoration: overline">X003</span>
</td><td width="40%" height="16" style="border:solid 1px black"><em>Y003</em><input type="radio" name="R1"><input type="radio" name="R1" checked></td></tr> </table>
</div>
<p>1：若只打印《表单一》,看一下<a href="javascript:prn1_preview()">打印预览</a>,可<a href="javascript:prn1_print()">直接打印</a>也可      
<a href="javascript:prn1_printA()">选择打印机</a>打印。<br><br>
2：若《表单一》和《表单二》一起并列输出,看一下<a href="javascript:prn2_preview()">打印预览</a>,其布局风格可<a href="javascript:prn2_manage()">打印维护</a>调整。
<p>3：若打印整个页面,看看<a href="javascript:prn3_preview()">打印预览</a>。<br><br>
本例要点是用Document的innerHTML方法把打印目标的超文本送给控件。  
<p><a href="PrintSampIndex.html">&lt;&lt;回样例目录</a>
</p>   
<script language="javascript" type="text/javascript">   
        var LODOP; //声明为全局变量 
	function prn1_preview() {	
		CreateOneFormPage();	
		LODOP.PREVIEW();	
	};
	function prn1_print() {		
		CreateOneFormPage();
		LODOP.PRINT();	
	};
	function prn1_printA() {		
		CreateOneFormPage();
		LODOP.PRINTA(); 	
	};	
	function CreateOneFormPage(){
		LODOP=getLodop();  
		

LODOP.PRINT_INITA(10,10,762,533,"成都职业技术学院专用发票");
LODOP.SET_PRINT_STYLE("FontColor","#0000FF");
LODOP.ADD_PRINT_SHAPE(2,116,43,655,373,0,1,"#800000");
LODOP.ADD_PRINT_SHAPE(1,144,44,653,1,0,1,"#800000");
LODOP.ADD_PRINT_SHAPE(1,172,44,653,1,0,1,"#800000");
LODOP.ADD_PRINT_SHAPE(0,116,143,1,56,0,1,"#800000");
LODOP.ADD_PRINT_SHAPE(0,116,488,1,56,0,1,"#800000");
LODOP.ADD_PRINT_SHAPE(0,116,574,1,372,0,1,"#800000");
LODOP.ADD_PRINT_SHAPE(0,172,166,1,282,0,1,"#800000");
LODOP.ADD_PRINT_SHAPE(0,172,415,1,282,0,1,"#800000");
LODOP.ADD_PRINT_SHAPE(1,454,44,653,1,0,1,"#800000");
LODOP.ADD_PRINT_SHAPE(0,454,130,1,34,0,1,"#800000");
LODOP.ADD_PRINT_SHAPE(0,454,483,1,34,0,1,"#800000");
LODOP.ADD_PRINT_SHAPE(0,64,62,141,1,0,1,"#0000FF");
LODOP.ADD_PRINT_SHAPE(3,29,62,32,32,0,4,"#0000FF");
LODOP.ADD_PRINT_SHAPE(3,21,300,147,75,0,3,"#FF0000");
LODOP.ADD_PRINT_SHAPE(3,26,307,132,65,0,1,"#FF0000");
LODOP.ADD_PRINT_TEXT(33,237,301,30,"成都职业技术学院专用发票");
LODOP.SET_PRINT_STYLEA(0,"FontSize",15);
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",2);
LODOP.ADD_PRINT_TEXT(68,326,100,25,"发 票 联");
LODOP.SET_PRINT_STYLEA(0,"FontSize",11);
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",2);
LODOP.ADD_PRINT_TEXT(34,98,112,25,"成都职业技术学院");
LODOP.ADD_PRINT_SHAPE(2,37,69,18,15,0,1,"#0000FF");
LODOP.ADD_PRINT_SHAPE(2,40,73,10,9,0,1,"#0000FF");
LODOP.ADD_PRINT_TEXT(0,0,0,0,"移 动 信 息 专 家");
LODOP.SET_PRINT_STYLEA(0,"FontSize",8);
LODOP.SET_PRINT_STYLEA(0,"Alignment",2);
LODOP.ADD_PRINT_TEXT(124,58,68,20,"姓名");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",2);
LODOP.ADD_PRINT_TEXT(152,58,68,20,"学号");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",2);
LODOP.ADD_PRINT_TEXT(124,497,68,20,"受理类别");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",2);
LODOP.ADD_PRINT_TEXT(152,497,68,20,"合 同 号");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",2);
LODOP.ADD_PRINT_TEXT(465,54,68,20,"大写金额");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",2);
LODOP.ADD_PRINT_TEXT(465,495,104,20,"小写金额    ￥: ");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",3);
LODOP.ADD_PRINT_TEXT(98,56,47,20,"编号：");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",3);
LODOP.ADD_PRINT_TEXT(98,259,48,20,"日期：");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",3);
LODOP.ADD_PRINT_TEXT(97,500,71,20,"发票号码：");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",3);
LODOP.ADD_PRINT_TEXT(496,321,83,20,"收款人：");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",3);
LODOP.ADD_PRINT_TEXT(496,480,93,20,"收款单位名称：");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",3);
LODOP.ADD_PRINT_TEXT(226,703,27,121,"第二联发票联");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",2);
LODOP.ADD_PRINT_TEXT(203,21,17,195,"京地税准印八九号五百万份");
LODOP.SET_PRINT_STYLEA(0,"FontSize",8);
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",2);
LODOP.ADD_PRINT_TEXT(126,150,100,20,"郭德强");
LODOP.ADD_PRINT_TEXT(151,150,100,20,"13954885188");
LODOP.ADD_PRINT_TEXT(125,584,99,20,"发票打印");
LODOP.ADD_PRINT_TEXT(465,140,198,20,"陆百柒拾捌元叁角零分");
LODOP.ADD_PRINT_TEXT(465,599,70,20,"678.30");
LODOP.ADD_PRINT_TEXT(496,408,75,20,"收款人赵店");
LODOP.ADD_PRINT_TEXT(191,58,100,20,"国内漫游通话");
LODOP.ADD_PRINT_TEXT(191,217,100,20,"584.00");
LODOP.ADD_PRINT_TEXT(98,101,150,20,"101081005747319387");
LODOP.ADD_PRINT_TEXT(97,307,150,20,"2008年10月19日 10:28:38");
LODOP.ADD_PRINT_TEXT(152,584,103,20,"138860016786");
LODOP.ADD_PRINT_TEXT(95,571,112,20,"06775516");
LODOP.SET_PRINT_STYLEA(0,"FontName","System");
LODOP.ADD_PRINT_TEXT(76,500,71,20,"发票代码：");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#800000");
LODOP.SET_PRINT_STYLEA(0,"Alignment",3);
LODOP.ADD_PRINT_TEXT(74,571,112,20,"237090742401");
LODOP.SET_PRINT_STYLEA(0,"FontName","System");
LODOP.SET_PRINT_STYLEA(0,"FontColor","#FF0000");
LODOP.ADD_PRINT_TEXT(496,572,112,20,"收款单位名称填写");



	};	                     
	function prn2_preview() {	
		CreateTwoFormPage();	
		LODOP.PREVIEW();	
	};
	function prn2_manage() {	
		CreateTwoFormPage();
		LODOP.PRINT_SETUP();	
	};	
	function CreateTwoFormPage(){
		LODOP=getLodop();  
		LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_表单二");
		LODOP.ADD_PRINT_RECT(70,27,634,242,0,1);
		LODOP.ADD_PRINT_TEXT(29,236,279,38,"页面内容改变布局打印");
		LODOP.SET_PRINT_STYLEA(2,"FontSize",18);
		LODOP.SET_PRINT_STYLEA(2,"Bold",1);
		LODOP.ADD_PRINT_HTM(88,40,321,185,document.getElementById("form1").innerHTML);
		LODOP.ADD_PRINT_HTM(87,355,285,187,document.getElementById("form2").innerHTML);
		LODOP.ADD_PRINT_TEXT(319,58,500,30,"注：其中《表单一》按显示大小，《表单二》在程序控制宽度(285px)内自适应调整");
	}; 
	
	function prn3_preview(){
		LODOP=getLodop();  
		LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_全页");
		LODOP.ADD_PRINT_HTM(0,0,"100%","100%",document.documentElement.innerHTML);
		LODOP.PREVIEW();	
	};	
	
s

	
</script> 

</body>
</html>